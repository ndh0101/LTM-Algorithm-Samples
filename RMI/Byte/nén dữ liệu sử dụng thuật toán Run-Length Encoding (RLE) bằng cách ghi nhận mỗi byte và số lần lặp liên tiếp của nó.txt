private static byte[] runLengthEncoding(byte[] data) {
    if (data == null || data.length == 0) return new byte[0];
    // LinkedHashMap để giữ thứ tự xuất hiện lần đầu
    Map<Byte, Integer> counts = new LinkedHashMap<>();
    for (byte b : data) {
        counts.put(b, counts.getOrDefault(b, 0) + 1);
    }
    byte[] out = new byte[counts.size() * 2];
    int idx = 0;
    for (Map.Entry<Byte, Integer> e : counts.entrySet()) {
        out[idx++] = e.getKey();
        int cnt = e.getValue();
        out[idx++] = (byte) (cnt & 0xFF);
    }
    return out;
}